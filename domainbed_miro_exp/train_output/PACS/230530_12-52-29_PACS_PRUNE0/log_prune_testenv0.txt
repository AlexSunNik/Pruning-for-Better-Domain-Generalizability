[37m[36mINFO[0m[0m 05/30 12:52:29 | Command :: prune_all.py PACS_PRUNE0 --data_dir ../domain_bed/ --algorithm MIRO --dataset PACS --lr 3e-5 --resnet_dropout 0.0 --weight_decay 0.0 --ld 0.01 --testenv 0 --model_save 0 --steps 4000
Environment:
	Python: 3.8.5
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.22.4
	PIL: 9.2.0
Args:
	algorithm: MIRO
	checkpoint_freq: None
	configs: []
	data_dir: ../domain_bed
	dataset: PACS
	debug: False
	deterministic: True
	evalmode: fast
	holdout_fraction: 0.2
	model_save: 0
	name: PACS_PRUNE0
	out_dir: train_output/PACS/230530_12-52-29_PACS_PRUNE0
	out_root: train_output/PACS
	prebuild_loader: False
	prune_method: uni
	seed: 0
	show: False
	steps: 4000
	tb_freq: 10
	test_envs: None
	testenv: 0
	trial_seed: 0
	unique_name: 230530_12-52-29_PACS_PRUNE0
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	[36mresnet_dropout: 0.0
	[0mclass_balanced: False
	optimizer: adam
	freeze_bn: True
	pretrained: True
	[36mlr: 3e-05
	[0mbatch_size: 32
	[36mweight_decay: 0.0
	[0mswad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	[36mld: 0.01
	[0mlr_mult: 10.0
Dataset:
	[PACS] #envs=4, #classes=7
	env0: art_painting (#2048)
	env1: cartoon (#2344)
	env2: photo (#1670)
	env3: sketch (#3929)

[37m[36mINFO[0m[0m 05/30 12:52:29 | n_steps = 4000
[37m[36mINFO[0m[0m 05/30 12:52:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 05/30 12:52:29 | n_steps is updated to 4000 => 4001 for checkpointing
[37m[36mINFO[0m[0m 05/30 12:52:29 | Target test envs = [[0], [1], [2], [3]]
[37m[36mINFO[0m[0m 05/30 12:52:29 | Prune and finetune for test environment 0
[37m[36mINFO[0m[0m 05/30 12:52:29 | 
[37m[36mINFO[0m[0m 05/30 12:52:29 | Testenv name escaping te_art_painting -> te_art_painting
[37m[36mINFO[0m[0m 05/30 12:52:29 | Test envs = [0], name = te_art_painting
[37m[36mINFO[0m[0m 05/30 12:52:29 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 05/30 12:52:29 | steps-per-epoch for each domain: 58.62, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 05/30 12:52:45 | 23454912.0 parameters out of 23454912


[37m[36mINFO[0m[0m 05/30 12:52:45 | Pruning Completed
[37m[36mINFO[0m[0m 05/30 12:52:45 | 21135040.0 parameters out of 23454912


[37m[36mINFO[0m[0m 05/30 12:52:45 | # of params = 47034311
[37m[36mINFO[0m[0m 05/30 12:53:02 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_out    env2_out    env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 05/30 12:53:02 | 0.547895    0.564792    0.000000    0.901744    0.380983    0.547895    0.564792    0.927350    0.877246    0.900637    0           0.000000    0.887747    -5.970471   2.031068    14.997595  
[37m[36mINFO[0m[0m 05/30 12:55:06 | 0.735815    0.753056    0.000000    0.960772    0.148382    0.735815    0.753056    0.950855    0.976048    0.955414    200         4.790419    -0.020818   -5.712937   0.542820    15.229619  
[37m[36mINFO[0m[0m 05/30 12:57:10 | 0.826724    0.828851    0.000000    0.969593    0.110891    0.826724    0.828851    0.972222    0.976048    0.960510    400         9.580838    -0.043658   -5.951261   0.545590    14.961295  
[37m[36mINFO[0m[0m 05/30 12:59:15 | 0.795607    0.826406    0.000000    0.956359    0.158826    0.795607    0.826406    0.959402    0.958084    0.951592    600         14.371257   -0.044860   -6.115053   0.546584    14.955868  
[37m[36mINFO[0m[0m 05/30 13:01:19 | 0.812691    0.831296    0.000000    0.960492    0.137565    0.812691    0.831296    0.965812    0.964072    0.951592    800         19.161677   -0.050427   -6.255035   0.546333    14.635826  
[37m[36mINFO[0m[0m 05/30 13:03:22 | 0.843197    0.843521    0.000000    0.964648    0.140638    0.843197    0.843521    0.976496    0.976048    0.941401    1000        23.952096   -0.051941   -6.394487   0.545832    14.770285  
[37m[36mINFO[0m[0m 05/30 13:05:26 | 0.793167    0.797066    0.000000    0.966030    0.150243    0.793167    0.797066    0.957265    0.979042    0.961783    1200        28.742515   -0.057819   -6.528336   0.544986    14.628058  
[37m[36mINFO[0m[0m 05/30 13:07:29 | 0.816351    0.833741    0.000000    0.963476    0.147927    0.816351    0.833741    0.967949    0.967066    0.955414    1400        33.532934   -0.062388   -6.663180   0.546700    13.939064  
[37m[36mINFO[0m[0m 05/30 13:09:33 | 0.760830    0.755501    0.000000    0.958064    0.168673    0.760830    0.755501    0.948718    0.970060    0.955414    1600        38.323353   -0.052201   -6.748078   0.545766    14.629231  
[37m[36mINFO[0m[0m 05/30 13:11:37 | 0.805369    0.804401    0.000000    0.969580    0.112173    0.805369    0.804401    0.965812    0.976048    0.966879    1800        43.113772   -0.046135   -6.778822   0.547738    14.312495  
[37m[36mINFO[0m[0m 05/30 13:13:39 | 0.839536    0.833741    0.000000    0.970304    0.104046    0.839536    0.833741    0.970085    0.979042    0.961783    2000        47.904192   -0.066886   -6.949960   0.544852    13.433383  
[37m[36mINFO[0m[0m 05/30 13:15:43 | 0.845027    0.843521    0.000000    0.969893    0.111421    0.845027    0.843521    0.976496    0.979042    0.954140    2200        52.694611   -0.068684   -7.116311   0.548029    13.899122  
[37m[36mINFO[0m[0m 05/30 13:17:45 | 0.812081    0.826406    0.000000    0.963322    0.155215    0.812081    0.826406    0.955128    0.973054    0.961783    2400        57.485030   -0.065007   -7.176455   0.544895    13.311158  
[37m[36mINFO[0m[0m 05/30 13:19:48 | 0.757169    0.753056    0.000000    0.944122    0.221021    0.757169    0.753056    0.918803    0.967066    0.946497    2600        62.275449   -0.062576   -7.250898   0.548337    13.489317  
[37m[36mINFO[0m[0m 05/30 13:21:51 | 0.867602    0.870416    0.000000    0.968308    0.124177    0.867602    0.870416    0.970085    0.973054    0.961783    2800        67.065868   -0.066698   -7.337923   0.546457    13.043145  
[37m[36mINFO[0m[0m 05/30 13:23:53 | 0.810250    0.831296    0.000000    0.971282    0.103602    0.810250    0.831296    0.974359    0.970060    0.969427    3000        71.856287   -0.069241   -7.467518   0.548666    12.771281  
[37m[36mINFO[0m[0m 05/30 13:25:56 | 0.816351    0.819071    0.000000    0.965036    0.145945    0.816351    0.819071    0.965812    0.970060    0.959236    3200        76.646707   -0.069161   -7.529103   0.547258    13.105342  
[37m[36mINFO[0m[0m 05/30 13:27:59 | 0.841367    0.863081    0.000000    0.971576    0.121214    0.841367    0.863081    0.965812    0.982036    0.966879    3400        81.437126   -0.064088   -7.558201   0.549385    12.749923  
[37m[36mINFO[0m[0m 05/30 13:30:01 | 0.863941    0.870416    0.000000    0.976859    0.094765    0.863941    0.870416    0.980769    0.988024    0.961783    3600        86.227545   -0.073618   -7.701027   0.548521    12.546289  
[37m[36mINFO[0m[0m 05/30 13:32:03 | 0.776083    0.784841    0.000000    0.953935    0.148931    0.776083    0.784841    0.950855    0.958084    0.952866    3800        91.017964   -0.071857   -7.817472   0.548579    12.047455  
[37m[36mINFO[0m[0m 05/30 13:34:04 | 0.766931    0.765281    0.000000    0.962185    0.139016    0.766931    0.765281    0.952991    0.973054    0.960510    4000        95.808383   -0.067070   -7.773509   0.550442    11.520078  
[37m[36mINFO[0m[0m 05/30 13:34:04 | ---
[37m[36mINFO[0m[0m 05/30 13:34:04 | training-domain validation = 86.394%
[37m[36mINFO[0m[0m 05/30 13:34:04 | === Summary ===
[37m[36mINFO[0m[0m 05/30 13:34:04 | Command: prune_all.py PACS_PRUNE0 --data_dir ../domain_bed/ --algorithm MIRO --dataset PACS --lr 3e-5 --resnet_dropout 0.0 --weight_decay 0.0 --ld 0.01 --testenv 0 --model_save 0 --steps 4000
[37m[36mINFO[0m[0m 05/30 13:34:04 | Unique name: 230530_12-52-29_PACS_PRUNE0
[37m[36mINFO[0m[0m 05/30 13:34:04 | Out path: train_output/PACS/230530_12-52-29_PACS_PRUNE0
[37m[36mINFO[0m[0m 05/30 13:34:04 | Algorithm: MIRO
[37m[36mINFO[0m[0m 05/30 13:34:04 | Dataset: PACS
