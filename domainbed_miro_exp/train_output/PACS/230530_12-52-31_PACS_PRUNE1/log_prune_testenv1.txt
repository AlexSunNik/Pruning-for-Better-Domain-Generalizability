[37m[36mINFO[0m[0m 05/30 12:52:31 | Command :: prune_all.py PACS_PRUNE1 --data_dir ../domain_bed/ --algorithm MIRO --dataset PACS --lr 3e-5 --resnet_dropout 0.0 --weight_decay 0.0 --ld 0.01 --testenv 1 --model_save 0 --steps 4000
Environment:
	Python: 3.8.5
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.22.4
	PIL: 9.2.0
Args:
	algorithm: MIRO
	checkpoint_freq: None
	configs: []
	data_dir: ../domain_bed
	dataset: PACS
	debug: False
	deterministic: True
	evalmode: fast
	holdout_fraction: 0.2
	model_save: 0
	name: PACS_PRUNE1
	out_dir: train_output/PACS/230530_12-52-31_PACS_PRUNE1
	out_root: train_output/PACS
	prebuild_loader: False
	prune_method: uni
	seed: 0
	show: False
	steps: 4000
	tb_freq: 10
	test_envs: None
	testenv: 1
	trial_seed: 0
	unique_name: 230530_12-52-31_PACS_PRUNE1
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	[36mresnet_dropout: 0.0
	[0mclass_balanced: False
	optimizer: adam
	freeze_bn: True
	pretrained: True
	[36mlr: 3e-05
	[0mbatch_size: 32
	[36mweight_decay: 0.0
	[0mswad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	[36mld: 0.01
	[0mlr_mult: 10.0
Dataset:
	[PACS] #envs=4, #classes=7
	env0: art_painting (#2048)
	env1: cartoon (#2344)
	env2: photo (#1670)
	env3: sketch (#3929)

[37m[36mINFO[0m[0m 05/30 12:52:31 | n_steps = 4000
[37m[36mINFO[0m[0m 05/30 12:52:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 05/30 12:52:31 | n_steps is updated to 4000 => 4001 for checkpointing
[37m[36mINFO[0m[0m 05/30 12:52:31 | Target test envs = [[0], [1], [2], [3]]
[37m[36mINFO[0m[0m 05/30 12:52:31 | Prune and finetune for test environment 1
[37m[36mINFO[0m[0m 05/30 12:52:31 | 
[37m[36mINFO[0m[0m 05/30 12:52:31 | Testenv name escaping te_cartoon -> te_cartoon
[37m[36mINFO[0m[0m 05/30 12:52:31 | Test envs = [1], name = te_cartoon
[37m[36mINFO[0m[0m 05/30 12:52:31 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 05/30 12:52:31 | steps-per-epoch for each domain: 51.22, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 05/30 12:52:46 | 23454912.0 parameters out of 23454912


[37m[36mINFO[0m[0m 05/30 12:52:46 | Pruning Completed
[37m[36mINFO[0m[0m 05/30 12:52:46 | 21135040.0 parameters out of 23454912


[37m[36mINFO[0m[0m 05/30 12:52:46 | # of params = 47034311
[37m[36mINFO[0m[0m 05/30 12:53:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_out    env1_in     env1_out    env2_out    env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 05/30 12:53:03 | 0.731343    0.756410    0.000000    0.861064    0.463756    0.767726    0.731343    0.756410    0.907186    0.908280    0           0.000000    0.886601    -5.937409   1.948644    14.570770  
[37m[36mINFO[0m[0m 05/30 12:55:06 | 0.819829    0.814103    0.000000    0.950318    0.181563    0.924205    0.819829    0.814103    0.970060    0.956688    200         4.790419    -0.007517   -5.698863   0.543198    14.924924  
[37m[36mINFO[0m[0m 05/30 12:57:10 | 0.826759    0.841880    0.000000    0.955713    0.144807    0.943765    0.826759    0.841880    0.973054    0.950318    400         9.580838    -0.036392   -5.896670   0.547664    14.468962  
[37m[36mINFO[0m[0m 05/30 12:59:15 | 0.770789    0.801282    0.000000    0.947850    0.185576    0.929095    0.770789    0.801282    0.973054    0.941401    600         14.371257   -0.043614   -6.064078   0.548996    14.565386  
[37m[36mINFO[0m[0m 05/30 13:01:19 | 0.751599    0.779915    0.000000    0.951489    0.176607    0.931540    0.751599    0.779915    0.970060    0.952866    800         19.161677   -0.042181   -6.201378   0.548886    14.521933  
[37m[36mINFO[0m[0m 05/30 13:03:22 | 0.791578    0.816239    0.000000    0.959466    0.141096    0.948655    0.791578    0.816239    0.973054    0.956688    1000        23.952096   -0.054729   -6.348032   0.549136    13.646817  
[37m[36mINFO[0m[0m 05/30 13:05:26 | 0.799041    0.814103    0.000000    0.955737    0.142171    0.951100    0.799041    0.814103    0.967066    0.949045    1200        28.742515   -0.052288   -6.471896   0.549968    13.753722  
[37m[36mINFO[0m[0m 05/30 13:07:29 | 0.748401    0.758547    0.000000    0.950205    0.160274    0.941320    0.748401    0.758547    0.964072    0.945223    1400        33.532934   -0.050557   -6.571484   0.548985    13.573748  
[37m[36mINFO[0m[0m 05/30 13:09:33 | 0.763859    0.762821    0.000000    0.953268    0.162708    0.936430    0.763859    0.762821    0.973054    0.950318    1600        38.323353   -0.055191   -6.661816   0.550246    13.935138  
[37m[36mINFO[0m[0m 05/30 13:11:38 | 0.813433    0.826923    0.000000    0.951203    0.162630    0.941320    0.813433    0.826923    0.967066    0.945223    1800        43.113772   -0.053090   -6.777905   0.550681    14.164596  
[37m[36mINFO[0m[0m 05/30 13:13:42 | 0.816098    0.831197    0.000000    0.960063    0.139211    0.955990    0.816098    0.831197    0.970060    0.954140    2000        47.904192   -0.057925   -6.884930   0.551414    14.189673  
[37m[36mINFO[0m[0m 05/30 13:15:46 | 0.823028    0.833333    0.000000    0.963851    0.137203    0.958435    0.823028    0.833333    0.970060    0.963057    2200        52.694611   -0.057803   -6.998276   0.550048    13.415853  
[37m[36mINFO[0m[0m 05/30 13:17:49 | 0.768657    0.797009    0.000000    0.961496    0.146624    0.946210    0.768657    0.797009    0.979042    0.959236    2400        57.485030   -0.062460   -7.094084   0.549321    13.301604  
[37m[36mINFO[0m[0m 05/30 13:19:52 | 0.735608    0.752137    0.000000    0.947873    0.213569    0.916870    0.735608    0.752137    0.970060    0.956688    2600        62.275449   -0.062278   -7.195691   0.549135    13.747208  
[37m[36mINFO[0m[0m 05/30 13:21:56 | 0.800640    0.807692    0.000000    0.963907    0.155744    0.955990    0.800640    0.807692    0.979042    0.956688    2800        67.065868   -0.064083   -7.250183   0.551390    12.900643  
[37m[36mINFO[0m[0m 05/30 13:23:59 | 0.768657    0.775641    0.000000    0.947873    0.242070    0.916870    0.768657    0.775641    0.970060    0.956688    3000        71.856287   -0.061150   -7.335083   0.548780    13.273423  
[37m[36mINFO[0m[0m 05/30 13:26:02 | 0.845416    0.867521    0.000000    0.958478    0.168471    0.938875    0.845416    0.867521    0.976048    0.960510    3200        76.646707   -0.066373   -7.436435   0.550457    13.368642  
[37m[36mINFO[0m[0m 05/30 13:28:05 | 0.720682    0.726496    0.000000    0.947014    0.224383    0.926650    0.720682    0.726496    0.964072    0.950318    3400        81.437126   -0.063749   -7.477379   0.550400    13.080973  
[37m[36mINFO[0m[0m 05/30 13:30:09 | 0.801173    0.824786    0.000000    0.955288    0.174532    0.943765    0.801173    0.824786    0.973054    0.949045    3600        86.227545   -0.067668   -7.575336   0.549751    13.546489  
[37m[36mINFO[0m[0m 05/30 13:32:13 | 0.820362    0.841880    0.000000    0.969587    0.133109    0.965770    0.820362    0.841880    0.985030    0.957962    3800        91.017964   -0.073385   -7.689659   0.552388    13.257324  
[37m[36mINFO[0m[0m 05/30 13:34:14 | 0.797441    0.805556    0.000000    0.951779    0.220870    0.948655    0.797441    0.805556    0.955090    0.951592    4000        95.808383   -0.071182   -7.751325   0.549872    11.800863  
[37m[36mINFO[0m[0m 05/30 13:34:14 | ---
[37m[36mINFO[0m[0m 05/30 13:34:14 | training-domain validation = 82.036%
[37m[36mINFO[0m[0m 05/30 13:34:14 | === Summary ===
[37m[36mINFO[0m[0m 05/30 13:34:14 | Command: prune_all.py PACS_PRUNE1 --data_dir ../domain_bed/ --algorithm MIRO --dataset PACS --lr 3e-5 --resnet_dropout 0.0 --weight_decay 0.0 --ld 0.01 --testenv 1 --model_save 0 --steps 4000
[37m[36mINFO[0m[0m 05/30 13:34:14 | Unique name: 230530_12-52-31_PACS_PRUNE1
[37m[36mINFO[0m[0m 05/30 13:34:14 | Out path: train_output/PACS/230530_12-52-31_PACS_PRUNE1
[37m[36mINFO[0m[0m 05/30 13:34:14 | Algorithm: MIRO
[37m[36mINFO[0m[0m 05/30 13:34:14 | Dataset: PACS
