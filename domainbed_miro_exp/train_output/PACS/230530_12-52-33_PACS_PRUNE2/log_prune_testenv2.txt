[37m[36mINFO[0m[0m 05/30 12:52:33 | Command :: prune_all.py PACS_PRUNE2 --data_dir ../domain_bed/ --algorithm MIRO --dataset PACS --lr 3e-5 --resnet_dropout 0.0 --weight_decay 0.0 --ld 0.01 --testenv 2 --model_save 0 --steps 4000
Environment:
	Python: 3.8.5
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.22.4
	PIL: 9.2.0
Args:
	algorithm: MIRO
	checkpoint_freq: None
	configs: []
	data_dir: ../domain_bed
	dataset: PACS
	debug: False
	deterministic: True
	evalmode: fast
	holdout_fraction: 0.2
	model_save: 0
	name: PACS_PRUNE2
	out_dir: train_output/PACS/230530_12-52-33_PACS_PRUNE2
	out_root: train_output/PACS
	prebuild_loader: False
	prune_method: uni
	seed: 0
	show: False
	steps: 4000
	tb_freq: 10
	test_envs: None
	testenv: 2
	trial_seed: 0
	unique_name: 230530_12-52-33_PACS_PRUNE2
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	[36mresnet_dropout: 0.0
	[0mclass_balanced: False
	optimizer: adam
	freeze_bn: True
	pretrained: True
	[36mlr: 3e-05
	[0mbatch_size: 32
	[36mweight_decay: 0.0
	[0mswad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	[36mld: 0.01
	[0mlr_mult: 10.0
Dataset:
	[PACS] #envs=4, #classes=7
	env0: art_painting (#2048)
	env1: cartoon (#2344)
	env2: photo (#1670)
	env3: sketch (#3929)

[37m[36mINFO[0m[0m 05/30 12:52:33 | n_steps = 4000
[37m[36mINFO[0m[0m 05/30 12:52:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 05/30 12:52:33 | n_steps is updated to 4000 => 4001 for checkpointing
[37m[36mINFO[0m[0m 05/30 12:52:33 | Target test envs = [[0], [1], [2], [3]]
[37m[36mINFO[0m[0m 05/30 12:52:33 | Prune and finetune for test environment 2
[37m[36mINFO[0m[0m 05/30 12:52:33 | 
[37m[36mINFO[0m[0m 05/30 12:52:34 | Testenv name escaping te_photo -> te_photo
[37m[36mINFO[0m[0m 05/30 12:52:34 | Test envs = [2], name = te_photo
[37m[36mINFO[0m[0m 05/30 12:52:34 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 05/30 12:52:34 | steps-per-epoch for each domain: 51.22, 58.62, 98.25 -> min = 51.22
[37m[36mINFO[0m[0m 05/30 12:52:47 | 23454912.0 parameters out of 23454912


[37m[36mINFO[0m[0m 05/30 12:52:48 | Pruning Completed
[37m[36mINFO[0m[0m 05/30 12:52:48 | 21135040.0 parameters out of 23454912


[37m[36mINFO[0m[0m 05/30 12:52:48 | # of params = 47034311
[37m[36mINFO[0m[0m 05/30 12:53:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_out    env1_out    env2_in     env2_out    env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 05/30 12:53:04 | 0.810629    0.769461    0.000000    0.866909    0.438815    0.797066    0.908120    0.810629    0.769461    0.895541    0           0.000000    1.100831    -6.048822   2.574606    13.965137  
[37m[36mINFO[0m[0m 05/30 12:55:07 | 0.958084    0.916168    0.000000    0.949888    0.175277    0.933985    0.961538    0.958084    0.916168    0.954140    200         3.904820    -0.006478   -5.760987   0.544510    14.206739  
[37m[36mINFO[0m[0m 05/30 12:57:10 | 0.948353    0.925150    0.000000    0.962311    0.156784    0.958435    0.974359    0.948353    0.925150    0.954140    400         7.809640    -0.038339   -6.001524   0.550084    12.929008  
[37m[36mINFO[0m[0m 05/30 12:59:14 | 0.979790    0.946108    0.000000    0.959873    0.154598    0.958435    0.959402    0.979790    0.946108    0.961783    600         11.714460   -0.033852   -6.170035   0.552780    13.768284  
[37m[36mINFO[0m[0m 05/30 13:01:19 | 0.965569    0.946108    0.000000    0.956387    0.153553    0.936430    0.972222    0.965569    0.946108    0.960510    800         15.619280   -0.054037   -6.314615   0.554382    13.175622  
[37m[36mINFO[0m[0m 05/30 13:03:22 | 0.950599    0.946108    0.000000    0.956100    0.146249    0.946210    0.967949    0.950599    0.946108    0.954140    1000        19.524100   -0.046770   -6.468388   0.553480    13.132730  
[37m[36mINFO[0m[0m 05/30 13:05:26 | 0.961826    0.949102    0.000000    0.957305    0.151704    0.941320    0.970085    0.961826    0.949102    0.960510    1200        23.428920   -0.052277   -6.554753   0.553731    13.141805  
[37m[36mINFO[0m[0m 05/30 13:07:30 | 0.964820    0.940120    0.000000    0.948361    0.202324    0.931540    0.959402    0.964820    0.940120    0.954140    1400        27.333740   -0.059895   -6.709376   0.553130    13.075936  
[37m[36mINFO[0m[0m 05/30 13:09:34 | 0.951347    0.913174    0.000000    0.946765    0.199535    0.924205    0.959402    0.951347    0.913174    0.956688    1600        31.238560   -0.054630   -6.807938   0.553353    13.199172  
[37m[36mINFO[0m[0m 05/30 13:11:38 | 0.958832    0.931138    0.000000    0.944443    0.196745    0.926650    0.948718    0.958832    0.931138    0.957962    1800        35.143380   -0.052538   -6.892289   0.554111    13.148599  
[37m[36mINFO[0m[0m 05/30 13:13:42 | 0.964820    0.937126    0.000000    0.954251    0.181295    0.936430    0.965812    0.964820    0.937126    0.960510    2000        39.048200   -0.055163   -6.970610   0.553771    13.637851  
[37m[36mINFO[0m[0m 05/30 13:15:46 | 0.961826    0.922156    0.000000    0.962551    0.160609    0.960880    0.970085    0.961826    0.922156    0.956688    2200        42.953020   -0.056970   -7.070242   0.554475    13.265231  
[37m[36mINFO[0m[0m 05/30 13:17:50 | 0.961078    0.916168    0.000000    0.961565    0.136995    0.951100    0.974359    0.961078    0.916168    0.959236    2400        46.857840   -0.055352   -7.164246   0.554228    12.369552  
[37m[36mINFO[0m[0m 05/30 13:19:53 | 0.962575    0.949102    0.000000    0.961092    0.144529    0.953545    0.967949    0.962575    0.949102    0.961783    2600        50.762660   -0.066645   -7.268361   0.553481    12.605567  
[37m[36mINFO[0m[0m 05/30 13:21:57 | 0.960329    0.937126    0.000000    0.951778    0.175451    0.958435    0.946581    0.960329    0.937126    0.950318    2800        54.667480   -0.062590   -7.363611   0.553936    13.239695  
[37m[36mINFO[0m[0m 05/30 13:24:00 | 0.964072    0.946108    0.000000    0.965606    0.130584    0.955990    0.976496    0.964072    0.946108    0.964331    3000        58.572300   -0.066543   -7.429032   0.553102    11.969330  
[37m[36mINFO[0m[0m 05/30 13:26:03 | 0.957335    0.928144    0.000000    0.952723    0.185932    0.943765    0.961538    0.957335    0.928144    0.952866    3200        62.477120   -0.072274   -7.595098   0.555808    12.392732  
[37m[36mINFO[0m[0m 05/30 13:28:06 | 0.946108    0.928144    0.000000    0.960853    0.164580    0.951100    0.972222    0.946108    0.928144    0.959236    3400        66.381940   -0.061063   -7.617277   0.555748    11.909845  
[37m[36mINFO[0m[0m 05/30 13:30:10 | 0.950599    0.925150    0.000000    0.950737    0.187622    0.943765    0.959402    0.950599    0.925150    0.949045    3600        70.286760   -0.063327   -7.646230   0.556433    12.219595  
[37m[36mINFO[0m[0m 05/30 13:32:14 | 0.954341    0.934132    0.000000    0.964202    0.142260    0.963325    0.963675    0.954341    0.934132    0.965605    3800        74.191580   -0.072005   -7.744018   0.555266    12.691301  
[37m[36mINFO[0m[0m 05/30 13:34:15 | 0.962575    0.949102    0.000000    0.965030    0.137076    0.965770    0.970085    0.962575    0.949102    0.959236    4000        78.096400   -0.072698   -7.861391   0.554660    10.839819  
[37m[36mINFO[0m[0m 05/30 13:34:15 | ---
[37m[36mINFO[0m[0m 05/30 13:34:15 | training-domain validation = 96.407%
[37m[36mINFO[0m[0m 05/30 13:34:15 | === Summary ===
[37m[36mINFO[0m[0m 05/30 13:34:15 | Command: prune_all.py PACS_PRUNE2 --data_dir ../domain_bed/ --algorithm MIRO --dataset PACS --lr 3e-5 --resnet_dropout 0.0 --weight_decay 0.0 --ld 0.01 --testenv 2 --model_save 0 --steps 4000
[37m[36mINFO[0m[0m 05/30 13:34:15 | Unique name: 230530_12-52-33_PACS_PRUNE2
[37m[36mINFO[0m[0m 05/30 13:34:15 | Out path: train_output/PACS/230530_12-52-33_PACS_PRUNE2
[37m[36mINFO[0m[0m 05/30 13:34:15 | Algorithm: MIRO
[37m[36mINFO[0m[0m 05/30 13:34:15 | Dataset: PACS
